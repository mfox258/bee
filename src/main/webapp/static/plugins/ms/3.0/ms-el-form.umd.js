(function(e,o){typeof exports=="object"&&typeof module<"u"?o(exports,require("axios"),require("vue"),require("vue3-sfc-loader")):typeof define=="function"&&define.amd?define(["exports","axios","vue","vue3-sfc-loader"],o):(e=typeof globalThis<"u"?globalThis:e||self,o(e.MsElForm={},e.axios,e.Vue,e.vue3SfcLoader))})(this,function(exports,axios,Vue,vue3SfcLoader){"use strict";function _interopNamespaceDefault(e){const o=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const l in e)if(l!=="default"){const r=Object.getOwnPropertyDescriptor(e,l);Object.defineProperty(o,l,r.get?r:{enumerable:!0,get:()=>e[l]})}}return o.default=e,Object.freeze(o)}const Vue__namespace=_interopNamespaceDefault(Vue),msIcon_vue_vue_type_style_index_0_scoped_15364228_lang="",_export_sfc=(e,o)=>{const l=e.__vccOpts||e;for(const[r,i]of o)l[r]=i;return l},_sfc_main$4={name:"ms-icon",props:["value"],data:function(){return{dialogVisible:!1,icons:[],mark:-1}},methods:{openIconList:function(){this.dialogVisible=!0},selected:function(e,o){this.$emit("update:value","icon-"+e),this.mark=o},select:function(){this.dialogVisible=!1},iconList:function(){var e=this;axios.create().get(ms.base+"/static/plugins/iconfont/1.0.0/iconfont.json",{}).then(function(o){e.icons=o.data.glyphs}).catch(function(o){console.log(o)})}},created:function(){this.iconList()}},_hoisted_1$1={class:"list"},_hoisted_2$1=["onClick"];function _sfc_render$4(e,o,l,r,i,u){const n=Vue.resolveComponent("el-button"),s=Vue.resolveComponent("el-input"),V=Vue.resolveComponent("el-scrollbar"),p=Vue.resolveComponent("el-main"),f=Vue.resolveComponent("el-dialog");return Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.createVNode(s,{modelValue:l.value,disabled:""},{prepend:Vue.withCtx(()=>[Vue.createElementVNode("i",{style:{"line-height":"1"},class:Vue.normalizeClass(["iconfont",l.value])},null,2)]),append:Vue.withCtx(()=>[Vue.createVNode(n,{class:"el-icon-search",onClick:u.openIconList},null,8,["onClick"])]),_:1},8,["modelValue"]),Vue.createVNode(f,{title:"选择图标",modelValue:e.dialogVisible,"onUpdate:modelValue":o[1]||(o[1]=d=>e.dialogVisible=d),width:"80%",class:"ms-Icons","close-on-click-modal":!1,"append-to-body":""},{footer:Vue.withCtx(()=>[Vue.createElementVNode("div",null,[Vue.createVNode(n,{size:"default",onClick:o[0]||(o[0]=d=>e.dialogVisible=!1)},{default:Vue.withCtx(()=>[Vue.createTextVNode("取 消")]),_:1}),Vue.createVNode(n,{size:"default",type:"primary",onClick:u.select},{default:Vue.withCtx(()=>[Vue.createTextVNode("确 定")]),_:1},8,["onClick"])])]),default:Vue.withCtx(()=>[Vue.createVNode(p,null,{default:Vue.withCtx(()=>[Vue.createVNode(V,{style:{height:"100%"}},{default:Vue.withCtx(()=>[Vue.createElementVNode("div",_hoisted_1$1,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.icons,(d,m)=>(Vue.openBlock(),Vue.createElementBlock("div",{key:m,class:Vue.normalizeClass(e.mark==m?"select":""),onClick:c=>u.selected(d.font_class,m)},[Vue.createElementVNode("i",{class:Vue.normalizeClass(["iconfont","icon-"+d.font_class])},null,2),Vue.createTextVNode("icon-"+Vue.toDisplayString(d.font_class),1)],10,_hoisted_2$1))),128))])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const MsIcon=_export_sfc(_sfc_main$4,[["render",_sfc_render$4],["__scopeId","data-v-15364228"]]),msMdiyForm_vue_vue_type_style_index_0_scoped_bd424c63_lang="",_sfc_main$3={props:{modelName:String,modelId:String,id:String,type:""},name:"ms-mdiy-form",data:function(){return{modelComp:null,conditionList:null,mdiyForm:{update:{url:ms.manager+"/mdiy/form/data/update.do",params:{}},save:{url:ms.manager+"/mdiy/form/data/save.do",params:{}},get:{url:ms.manager+"/mdiy/form/data/getData.do",params:{}}},mdiyConfig:{update:{url:ms.manager+"/mdiy/config/data/update.do",params:{}},save:{url:ms.manager+"/mdiy/config/data/update.do",params:{}},get:{url:ms.manager+"/mdiy/config/data/get.do",params:{}}},mdiyModel:{update:{url:ms.manager+"/mdiy/model/data/update.do",params:{}},save:{url:ms.manager+"/mdiy/model/data/save.do",params:{}},get:{url:ms.manager+"/mdiy/model/data.do",params:{}}},formURL:null}},watch:{modelName:function(e){debugger;this.render()}},methods:{getForm:function(){return this.$refs.form},render:function(){debugger;let that=this,getUrl="/mdiy/form/get.do";that.type==="form"?this.formURL=this.mdiyForm:that.type==="config"?(this.formURL=this.mdiyConfig,getUrl="/mdiy/config/get.do"):that.type==="model"&&(this.formURL=this.mdiyModel,getUrl="/mdiy/model/get.do");const render=e=>{try{const o={moduleCache:{vue:Vue__namespace},async getFile(){return e},addStyle(r){const i=Object.assign(document.createElement("style"),{textContent:r}),u=document.head.getElementsByTagName("style")[0]||null;document.head.insertBefore(i,u)}},l=Vue.defineAsyncComponent(()=>{debugger;return vue3SfcLoader.loadModule("modelComp.vue",o)});that.modelComp=Vue.shallowRef(l)}catch(o){console.error(o)}};ms.http.get(ms.manager+getUrl,{modelName:this.modelName}).then(function(res){if(res.result&&res.data){var data=JSON.parse(res.data.modelJson);that.conditionList=eval(data.searchJson);var data=JSON.parse(res.data.modelJson),html=data.html,script="<script>"+data.script.replace(`\r
});\r
`,`\r
}`)+"<\/script>";let code=html+script;code=code.replace('var custom_model = Vue.component("custom-model",{',"export default{"),code=code.replace("el: '#custom-model',",""),that.formURL.get.params=Object.assign({modelName:that.modelName,id:that.id,linkId:that.id},that.formURL.get.params),!that.id&&that.type!="config"&&(code=code.replace("that.get();","")),code=code.replace(/\}\);\s*<\/script>/,"};<\/script>"),code=code.replace("save:function(callback) {","save:function(callback) { debugger;"),code=code.replace("modelId:0,","formURL:"+JSON.stringify(that.formURL)+`,
 modelId:'`+res.data.id+"',"),code=code.replace("modelName:0,","modelName:'"+that.modelName+"',"),window.ms.debug&&console.log(code),render(code),that.loading=!1}})}},created:function(){this.render()}};function _sfc_render$3(e,o,l,r,i,u){return Vue.openBlock(),Vue.createBlock(Vue.resolveDynamicComponent(e.modelComp),{ref:"form"},null,512)}const MsMdiyForm=_export_sfc(_sfc_main$3,[["render",_sfc_render$3],["__scopeId","data-v-bd424c63"]]),msSearch_vue_vue_type_style_index_0_lang="",_sfc_main$2={name:"ms-search",props:{conditionData:{type:Array,default:[]},conditions:{type:Array,default:[]},searchKey:{type:String},closed:{type:Boolean,default:!0}},watch:{list:{handler:function(e){this.$emit("update:conditions",e)},deep:!0}},data:function(){return{searchVisible:!1,condition:this.conditionData,list:this.conditions}},methods:{delField:function(e){this.list.splice(e,1)},select:function(e){this.list.push(Object.assign({},this.condition[e],{value:this.condition[e].type=="switch"?!1:""}))},open:function(){this.searchVisible=!0},close:function(){this.searchVisible=!1},dateChange:function(e){e.el==="range"?e.value=[]:e.value=""},search:function(){var e=this;e.close&&e.close();var o=[];e.list.forEach(function(l){l.el==="range"?l.value.length&&o.push(l):l.value&&o.push(l)}),e.$emit("search",o)},save:function(){}}},_hoisted_1={key:3},_hoisted_2={class:"dialog-footer"};function _sfc_render$2(e,o,l,r,i,u){const n=Vue.resolveComponent("el-option"),s=Vue.resolveComponent("el-select"),V=Vue.resolveComponent("el-form-item"),p=Vue.resolveComponent("el-form"),f=Vue.resolveComponent("el-scrollbar"),d=Vue.resolveComponent("el-col"),m=Vue.resolveComponent("el-row"),c=Vue.resolveComponent("el-table-column"),y=Vue.resolveComponent("el-input"),g=Vue.resolveComponent("el-switch"),v=Vue.resolveComponent("ms-employee"),h=Vue.resolveComponent("el-time-picker"),_=Vue.resolveComponent("el-date-picker"),w=Vue.resolveComponent("el-link"),k=Vue.resolveComponent("el-table"),C=Vue.resolveComponent("el-button"),b=Vue.resolveComponent("el-dialog");return Vue.openBlock(),Vue.createBlock(b,{id:"search",title:"筛选",modelValue:e.searchVisible,"onUpdate:modelValue":o[0]||(o[0]=t=>e.searchVisible=t),"close-on-click-modal":!1,width:"70%"},{footer:Vue.withCtx(()=>[Vue.createElementVNode("span",_hoisted_2,[Vue.createVNode(C,{type:"primary",size:"default",onClick:u.search},{default:Vue.withCtx(()=>[Vue.createTextVNode("查询")]),_:1},8,["onClick"])])]),default:Vue.withCtx(()=>[Vue.createVNode(m,null,{default:Vue.withCtx(()=>[Vue.createVNode(d,{span:24},{default:Vue.withCtx(()=>[Vue.createVNode(f,{class:"ms-scrollbar",style:{height:"100%"}},{default:Vue.withCtx(()=>[Vue.createVNode(p,{ref:"form","label-width":"120px",size:"default"},{default:Vue.withCtx(()=>[Vue.createVNode(V,{label:"添加筛选条件:"},{default:Vue.withCtx(()=>[Vue.createVNode(s,{onChange:u.select},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.condition,(t,a)=>(Vue.openBlock(),Vue.createBlock(n,{key:t.index,value:a,label:t.name},null,8,["value","label"]))),128))]),_:1},8,["onChange"])]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1}),Vue.createVNode(k,{size:"default","show-header":!1,data:e.list,style:{width:"100%"}},{default:Vue.withCtx(()=>[Vue.createVNode(c,{prop:"name",width:"110"}),Vue.createVNode(c,{width:"130"},{default:Vue.withCtx(t=>[t.row.type=="input"||t.row.type=="textarea"?(Vue.openBlock(),Vue.createBlock(s,{key:0,modelValue:t.row.el,"onUpdate:modelValue":a=>t.row.el=a,size:"default"},{default:Vue.withCtx(()=>[Vue.createVNode(n,{label:"等于",value:"eq"}),Vue.createVNode(n,{label:"包含",value:"like"}),Vue.createVNode(n,{label:"左等于",value:"likeLeft"}),Vue.createVNode(n,{label:"右等于",value:"likeRight"})]),_:2},1032,["modelValue","onUpdate:modelValue"])):Vue.createCommentVNode("",!0),t.row.type=="number"?(Vue.openBlock(),Vue.createBlock(s,{key:1,modelValue:t.row.el,"onUpdate:modelValue":a=>t.row.el=a,size:"default"},{default:Vue.withCtx(()=>[Vue.createVNode(n,{label:"大于",value:"gt"}),Vue.createVNode(n,{label:"小于",value:"lt"}),Vue.createVNode(n,{label:"等于",value:"eq"}),Vue.createVNode(n,{label:"大于等于",value:"gte"}),Vue.createVNode(n,{label:"小于等于",value:"lte"})]),_:2},1032,["modelValue","onUpdate:modelValue"])):Vue.createCommentVNode("",!0),t.row.type=="date"||t.row.type=="time"?(Vue.openBlock(),Vue.createBlock(s,{key:2,modelValue:t.row.el,"onUpdate:modelValue":a=>t.row.el=a,size:"default",onChange:a=>u.dateChange(t.row)},{default:Vue.withCtx(()=>[Vue.createVNode(n,{label:"大于",value:"gt"}),Vue.createVNode(n,{label:"等于",value:"eq"}),Vue.createVNode(n,{label:"小于",value:"lt"}),Vue.createVNode(n,{label:"范围",value:"range"})]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])):Vue.createCommentVNode("",!0),t.row.hasOwnProperty("multiple")||t.row.type=="switch"||t.row.type=="role"?(Vue.openBlock(),Vue.createElementBlock("span",_hoisted_1,"是")):Vue.createCommentVNode("",!0)]),_:1}),Vue.createVNode(c,null,{default:Vue.withCtx(t=>[t.row.type=="input"||t.row.type=="number"||t.row.type=="textarea"?(Vue.openBlock(),Vue.createBlock(y,{key:0,style:{width:"200px"},modelValue:t.row.value,"onUpdate:modelValue":a=>t.row.value=a,size:"default"},null,8,["modelValue","onUpdate:modelValue"])):Vue.createCommentVNode("",!0),t.row.hasOwnProperty("multiple")?(Vue.openBlock(),Vue.createBlock(s,{key:1,style:{width:"200px"},modelValue:t.row.value,"onUpdate:modelValue":a=>t.row.value=a,size:"default"},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.$parent[t.row.model+"Options"],a=>(Vue.openBlock(),Vue.createBlock(n,{key:a[t.row.key],value:a[t.row.key],label:a[t.row.title]},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):Vue.createCommentVNode("",!0),t.row.type=="switch"?(Vue.openBlock(),Vue.createBlock(g,{key:2,modelValue:t.row.value,"onUpdate:modelValue":a=>t.row.value=a},null,8,["modelValue","onUpdate:modelValue"])):Vue.createCommentVNode("",!0),t.row.type=="role"?(Vue.openBlock(),Vue.createBlock(v,{key:3,size:"default",modelValue:t.row.value,"onUpdate:modelValue":a=>t.row.value=a},null,8,["modelValue","onUpdate:modelValue"])):Vue.createCommentVNode("",!0),t.row.type=="time"?(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,{key:4},[t.row.el=="range"?(Vue.openBlock(),Vue.createBlock(h,{key:0,size:"default",clearable:"","is-range":"","value-format":"HH:mm:ss","range-separator":"至","start-placeholder":"请选择开始时间","end-placeholder":"请选择结束时间",modelValue:t.row.value,"onUpdate:modelValue":a=>t.row.value=a},null,8,["modelValue","onUpdate:modelValue"])):(Vue.openBlock(),Vue.createBlock(h,{key:1,size:"default",clearable:"","value-format":"HH:mm:ss",modelValue:t.row.value,"onUpdate:modelValue":a=>t.row.value=a},null,8,["modelValue","onUpdate:modelValue"]))],64)):Vue.createCommentVNode("",!0),t.row.type=="date"?(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,{key:5},[t.row.el=="range"?(Vue.openBlock(),Vue.createBlock(_,{key:0,size:"default",modelValue:t.row.value,"onUpdate:modelValue":a=>t.row.value=a,type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss","start-placeholder":"请选择开始日期","end-placeholder":"请选择结束日期"},null,8,["modelValue","onUpdate:modelValue"])):(Vue.openBlock(),Vue.createBlock(_,{key:1,size:"default",clearable:"","value-format":"yyyy-MM-dd HH:mm:ss",modelValue:t.row.value,"onUpdate:modelValue":a=>t.row.value=a},null,8,["modelValue","onUpdate:modelValue"]))],64)):Vue.createCommentVNode("",!0)]),_:1}),Vue.createVNode(c,{align:"center",width:"130"},{default:Vue.withCtx(t=>[t.$index!=e.list.length-1?(Vue.openBlock(),Vue.createBlock(s,{key:0,modelValue:t.row.action,"onUpdate:modelValue":a=>t.row.action=a,size:"default"},{default:Vue.withCtx(()=>[Vue.createVNode(n,{label:"与",value:"and"}),Vue.createVNode(n,{label:"或",value:"or"})]),_:2},1032,["modelValue","onUpdate:modelValue"])):Vue.createCommentVNode("",!0)]),_:1}),Vue.createVNode(c,{align:"center",width:"60"},{default:Vue.withCtx(t=>[Vue.createVNode(w,{type:"primary",underline:!1,onClick:a=>u.delField(t.$index)},{default:Vue.withCtx(()=>[Vue.createTextVNode("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1},8,["modelValue"])}const MsSearch=_export_sfc(_sfc_main$2,[["render",_sfc_render$2]]),_sfc_main$1={name:"ms-employee",props:{emitPath:{type:Boolean,default:!1},url:String,multiple:{type:Boolean,default:!1},value:String|Number},data:function(){return{dataList:[],dataProps:{multiple:this.multiple,emitPath:this.emitPath,checkStrictly:!1,expandTrigger:"hover"}}},computed:{select:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}},watch:{url:function(e,o){this.list(e)}},methods:{list:function(e){var o=this;ms.http.get(e,{employeeStatus:"in"}).then(function(l){l.result?o.dataList=l.data:o.dataList=[]})}},created:function(){this.list(this.url?this.url:ms.manager+"/organization/employee/getPostEmployeeBeans.do")}};function _sfc_render$1(e,o,l,r,i,u){const n=Vue.resolveComponent("el-cascader");return Vue.openBlock(),Vue.createBlock(n,Vue.mergeProps(e.$attrs,{options:e.dataList,props:e.dataProps,modelValue:u.select,"onUpdate:modelValue":o[0]||(o[0]=s=>u.select=s)}),null,16,["options","props","modelValue"])}const MsEmployee=_export_sfc(_sfc_main$1,[["render",_sfc_render$1]]),_sfc_main={name:"ms-upload",props:{modelValue:{type:String,required:!0},proxy:String},data:function(){return{list:[],ms}},watch:{list:{handler:function(e,o){var l;e.length?l=JSON.stringify(e):l="",this.$emit("update:modelValue",l)},deep:!0},modelValue:function(e,o){this.initList()}},methods:{success:function(e,o,l){if(e.result){debugger;this.proxy&&(e.data=this.proxy+e.data),o.url=ms.base+e.data,o.path=o.url,this.list.push({url:o.url,name:o.name,path:e.data,uid:o.uid})}else this.$notify({title:"失败",message:e.msg,type:"warning"})},error:function(e,o,l){var r=e.toString();r.indexOf("Error")>-1&&(r=r.replace("Error: ",""),r=JSON.parse(r),r=r.msg),this.$notify({title:"失败",message:r,type:"warning"})},preview:function(e){this.$emit("on-preview",e),window.open(e.url)},remove:function(e,o){var l=-1;l=this.list.findIndex(function(r){return r==e}),l!=-1&&this.list.splice(l,1)},removeFiles:function(){this.list=[],this.$refs.upload.clearFiles()},exceed:function(e,o){this.$notify({title:"提示",message:"当前最多上传"+this.$attrs.limit+"个附件",type:"warning"})},initList:function(){if(this.modelValue)try{this.list=JSON.parse(this.modelValue),this.list.forEach(function(e){e.response&&e.response.data?e.url=ms.base+e.response.data:e.url=ms.base+e.path})}catch{this.list=[]}else this.list=[]}},mounted:function(){console.log(this),this.initList()}};function _sfc_render(e,o,l,r,i,u){const n=Vue.resolveComponent("el-upload");return Vue.openBlock(),Vue.createBlock(n,Vue.mergeProps({ref:"upload"},e.$attrs,{"on-success":u.success,"on-remove":u.remove,"on-preview":u.preview,"on-exceed":u.exceed,"on-error":u.error,"file-list":e.list}),{default:Vue.withCtx(()=>[Vue.renderSlot(e.$slots,"trigger",{slot:"trigger"}),Vue.renderSlot(e.$slots,"tip",{slot:"tip"}),Vue.renderSlot(e.$slots,"default")]),_:3},16,["on-success","on-remove","on-preview","on-exceed","on-error","file-list"])}const MsUpload=_export_sfc(_sfc_main,[["render",_sfc_render]]),components=[MsIcon,MsMdiyForm,MsSearch,MsEmployee,MsUpload],install=(e,o)=>{components.forEach(l=>{l.install=r=>{r.component(l.name,l),o&&o.debug&&console.log("注册",l.name)},e.use((l.name,l))})},index={install};exports.MsEmployee=MsEmployee,exports.MsIcon=MsIcon,exports.MsMdiyForm=MsMdiyForm,exports.MsSearch=MsSearch,exports.MsUpload=MsUpload,exports.default=index,exports.install=install,Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
